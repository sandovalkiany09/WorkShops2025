<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gestión de Profesores</title>
  <script>
    // Función para listar profesores
    function listTeachers() {
      const ajaxRequest = new XMLHttpRequest();
      ajaxRequest.open("GET", "http://localhost:3000/api/teachers");
      ajaxRequest.send();

      ajaxRequest.onload = () => {
        if (ajaxRequest.status === 200) {
          const teachers = JSON.parse(ajaxRequest.responseText);
          const resultDiv = document.getElementById("result");
          resultDiv.innerHTML = "";

          teachers.forEach(teacher => {
            const div = document.createElement("div");
            div.textContent = `Nombre: ${teacher.name}, Materia: ${teacher.subject}`;

            // Crear el botón de editar
            const editButton = document.createElement("button");
            editButton.textContent = "Editar";
            editButton.onclick = () => {
              document.getElementById("teacherId").value = teacher._id;
              document.getElementById("teacherNameUpdate").value = teacher.name;
              document.getElementById("teacherSubjectUpdate").value = teacher.subject;
            };

            // Crear el botón de eliminar
            const deleteButton = document.createElement("button");
            deleteButton.textContent = "Eliminar";
            deleteButton.onclick = () => {
              document.getElementById("teacherIdDelete").value = teacher._id;
            };

            div.appendChild(editButton);
            div.appendChild(deleteButton);
            resultDiv.appendChild(div);
          });
        } else {
          alert("Error al obtener los profesores");
        }
      };
    }

    // Función para crear un profesor
    function createTeacher() {
      const teacher = {
        name: document.getElementById("teacherName").value,
        subject: document.getElementById("teacherSubject").value
      };

      const ajaxRequest = new XMLHttpRequest();
      ajaxRequest.open("POST", "http://localhost:3000/api/teachers");
      ajaxRequest.setRequestHeader("Content-Type", "application/json");
      ajaxRequest.send(JSON.stringify(teacher));

      ajaxRequest.onload = () => {
        if (ajaxRequest.status === 201) {
          alert("Profesor creado correctamente");
          listTeachers(); // Refresca la lista de profesores
        } else {
          alert("Error al crear el profesor");
        }
      };
    }

    // Función para actualizar un profesor
    function updateTeacher() {
    const teacher = {
      name: document.getElementById("teacherNameUpdate").value,
      subject: document.getElementById("teacherSubjectUpdate").value
    };

    const teacherId = document.getElementById("teacherId").value;

    const ajaxRequest = new XMLHttpRequest();
    ajaxRequest.open("PUT", `http://localhost:3000/api/teachers?id=${teacherId}`);
    ajaxRequest.setRequestHeader("Content-Type", "application/json");
    ajaxRequest.send(JSON.stringify(teacher));

    ajaxRequest.onload = () => {
      if (ajaxRequest.status === 200) {
        alert("Profesor actualizado correctamente");
        listTeachers(); // Refresca la lista de profesores
      } else {
        alert("Error al actualizar el profesor");
      }
    };
  }

    // Función para eliminar un profesor
    function deleteTeacher() {
    const teacherId = document.getElementById("teacherIdDelete").value;

    const ajaxRequest = new XMLHttpRequest();
    ajaxRequest.open("DELETE", `http://localhost:3000/api/teachers?id=${teacherId}`);
    ajaxRequest.setRequestHeader("Content-Type", "application/json");
    ajaxRequest.send();

    ajaxRequest.onload = () => {
      if (ajaxRequest.status === 200) {
        alert("Profesor eliminado correctamente");
        listTeachers(); // Refresca la lista de profesores
      } else {
        alert("Error al eliminar el profesor");
      }
    };
  }

  </script>
</head>

<body>
  <h1>Gestión de Profesores</h1>

  <!-- Crear Profesor -->
  <h2>Crear Profesor</h2>
  <label for="teacherName">Nombre:</label>
  <input type="text" id="teacherName">
  <label for="teacherSubject">Materia:</label>
  <input type="text" id="teacherSubject">
  <button onclick="createTeacher();">Crear</button>

  <!-- Listar Profesores -->
  <h2>Listar Profesores</h2>
  <button onclick="listTeachers();">Listar</button>
  <div id="result"></div>

  <!-- Actualizar Profesor -->
  <h2>Actualizar Profesor</h2>
  <label for="teacherId">ID:</label>
  <input type="text" id="teacherId" readonly>
  <label for="teacherNameUpdate">Nombre:</label>
  <input type="text" id="teacherNameUpdate">
  <label for="teacherSubjectUpdate">Materia:</label>
  <input type="text" id="teacherSubjectUpdate">
  <button onclick="updateTeacher();">Actualizar</button>

  <!-- Eliminar Profesor -->
  <h2>Eliminar Profesor</h2>
  <label for="teacherIdDelete">ID del Profesor a Eliminar:</label>
  <input type="text" id="teacherIdDelete">
  <button onclick="deleteTeacher();">Eliminar</button>
</body>

</html>
